# Backend-specific mise configuration for Rails tasks
# This extends the root mise.toml with Rails-specific functionality

[tools]
ruby = "3.4.3"

[env]
RAILS_ENV = "development"

# === RAILS-SPECIFIC TASKS ===

[tasks."rails:server"]
alias = "s"
description = "ğŸš‚ Start Rails server only"
run = "bin/rails server"

[tasks."rails:console"]
alias = "c"
description = "ğŸ’» Open Rails console"
raw = true
run = "bin/rails console"

[tasks."rails:generate"]
alias = "g"
description = "âš¡ Generate Rails components"
run = "bin/rails generate"

[tasks."rails:destroy"]
alias = "d"
description = "ğŸ—‘ï¸ Destroy Rails components"
run = "bin/rails destroy"

[tasks."rails:routes"]
alias = "r"
description = "ğŸ—ºï¸ Show all Rails routes"
run = "bin/rails routes"

[tasks."rails:middleware"]
description = "ğŸ”§ Show Rails middleware stack"
run = "bin/rails middleware"

[tasks."rails:stats"]
description = "ğŸ“Š Show code statistics"
run = "bin/rails stats"

# === DATABASE TASKS ===

[tasks."db:create"]
description = "ğŸ—„ï¸ Create database"
run = "bin/rails db:create"

[tasks."db:drop"]
description = "ğŸ—‘ï¸ Drop database"
confirm = "Are you sure you want to drop the database?"
run = "bin/rails db:drop"

[tasks."db:schema:load"]
description = "ğŸ“‹ Load database schema"
run = "bin/rails db:schema:load"

[tasks."db:schema:dump"]
description = "ğŸ“‹ Dump database schema"
run = "bin/rails db:schema:dump"

[tasks."db:version"]
description = "ğŸ“Š Show current database version"
run = "bin/rails db:version"

[tasks."db:fixtures:load"]
description = "ğŸ“¦ Load fixtures"
run = "bin/rails db:fixtures:load"

# === ASSET TASKS ===

[tasks."assets:precompile"]
description = "ğŸ¨ Precompile assets"
run = "bin/rails assets:precompile"

[tasks."assets:clean"]
description = "ğŸ§¹ Clean compiled assets"
run = "bin/rails assets:clean"

[tasks."assets:clobber"]
description = "ğŸ—‘ï¸ Remove all compiled assets"
run = "bin/rails assets:clobber"

# === CACHE TASKS ===

[tasks."cache:clear"]
description = "ğŸ§¹ Clear Rails cache"
run = "bin/rails cache:clear"

[tasks."tmp:clear"]
description = "ğŸ§¹ Clear tmp files"
run = "bin/rails tmp:clear"

[tasks."tmp:create"]
description = "ğŸ“ Create tmp directories"
run = "bin/rails tmp:create"

# === LOG TASKS ===

[tasks."log:clear"]
description = "ğŸ§¹ Clear log files"
run = "bin/rails log:clear"

[tasks."log:tail"]
alias = "logs"
description = "ğŸ“‹ Tail development log"
run = "tail -f log/development.log"

# === TESTING TASKS ===

[tasks."test:system"]
description = "ğŸ§ª Run system tests"
run = "bin/rails test:system"

[tasks."test:models"]
description = "ğŸ§ª Run model tests"
run = "bundle exec rspec spec/models"

[tasks."test:controllers"]
description = "ğŸ§ª Run controller tests"
run = "bundle exec rspec spec/controllers"

[tasks."test:requests"]
description = "ğŸ§ª Run request tests"
run = "bundle exec rspec spec/requests"

[tasks."test:jobs"]
description = "ğŸ§ª Run job tests"
run = "bundle exec rspec spec/jobs"

# === SECURITY TASKS ===

[tasks."brakeman"]
description = "ğŸ”’ Run security analysis with Brakeman"
run = "bundle exec brakeman"

[tasks."bundle:audit"]
description = "ğŸ” Audit gems for security vulnerabilities"
run = "bundle audit"

# === MAINTENANCE TASKS ===

[tasks."annotate"]
description = "ğŸ“ Annotate models with schema information"
run = "bundle exec annotate"

[tasks."yard"]
description = "ğŸ“š Generate documentation with YARD"
run = "bundle exec yard"

[tasks."rubocop:auto"]
description = "ğŸ”§ Auto-correct RuboCop offenses"
run = "bundle exec rubocop -a"

[tasks."rubocop:safe"]
description = "ğŸ”§ Safe auto-correct RuboCop offenses"
run = "bundle exec rubocop -A"
